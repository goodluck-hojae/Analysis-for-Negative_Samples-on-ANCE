Sun Nov 24 14:01:42 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:25:00.0 Off |                    0 |
| N/A   34C    P0             64W /  500W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:26:00.0 Off |                    0 |
| N/A   31C    P0             63W /  500W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
sbatch_initial_train_subset_10.sh
Loading conda
python -m torch.distributed.launch --nproc_per_node=2 drivers/run_ann_data_gen.py --training_dir /home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/checkpoints --init_model_dir /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000 --model_type rdot_nll --output_dir /home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/ann_data --cache_dir /home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/cache --data_dir /home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/preprocessed_data --max_seq_length 512 --per_gpu_eval_batch_size 2048 --topk_training 200 --negative_sample 200 --server_port 12345 --end_output_num -1 --ann_dir /home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/ann_data
/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
11/24/2024 14:01:58 - WARNING - __main__ -   Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True
11/24/2024 14:01:58 - WARNING - __main__ -   Process rank: 1, device: cuda:1, n_gpu: 1, distributed training: True
11/24/2024 14:01:58 - INFO - __main__ -   starting output number 0
11/24/2024 14:01:58 - INFO - __main__ -   Loading query_2_pos_docid
11/24/2024 14:01:58 - INFO - __main__ -   Loading dev query_2_pos_docid
11/24/2024 14:01:58 - INFO - __main__ -   52887
11/24/2024 14:01:58 - INFO - __main__ -   start generate ann data number 0
11/24/2024 14:01:58 - INFO - __main__ -   next checkpoint at /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000
11/24/2024 14:01:58 - INFO - transformers.configuration_utils -   loading configuration file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/config.json
11/24/2024 14:01:58 - INFO - transformers.configuration_utils -   Model config {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "eos_token_id": 2,
  "finetuning_task": "MSMarco",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

11/24/2024 14:01:58 - INFO - transformers.tokenization_utils -   Model name '/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000' not found in model shortcut name list (roberta-base, roberta-large, roberta-large-mnli, distilroberta-base, roberta-base-openai-detector, roberta-large-openai-detector). Assuming '/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000' is a path or url to a directory containing tokenizer files.
11/24/2024 14:01:58 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/vocab.json
11/24/2024 14:01:58 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/merges.txt
11/24/2024 14:01:58 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/added_tokens.json
11/24/2024 14:01:58 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/special_tokens_map.json
11/24/2024 14:01:58 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/tokenizer_config.json
Using mean: False
11/24/2024 14:01:59 - INFO - transformers.modeling_utils -   loading weights file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/pytorch_model.bin
Using mean: False
11/24/2024 14:02:47 - INFO - __main__ -   Inference parameters Namespace(ann_chunk_factor=5, ann_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/ann_data', ann_measure_topk_mrr=True, cache_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/cache', config_name='', data_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/preprocessed_data', device=device(type='cuda', index=0), end_output_num=-1, inference=False, init_model_dir='/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000', last_checkpoint_dir='', limit_total_number=100000, local_rank=0, max_doc_character=10000, max_query_length=64, max_seq_length=512, model_name_or_path='/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000', model_type='rdot_nll', n_gpu=1, negative_sample=200, no_cuda=False, only_keep_latest_embedding_file=False, output_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/ann_data', per_gpu_eval_batch_size=2048, rank=0, server_ip='', server_port='12345', tokenizer_name='', top_neg=0, topk_training=200, training_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/checkpoints', world_size=2)
6980 -1
11/24/2024 14:02:47 - INFO - __main__ -   ***** inference of dev query *****
6980 -1
11/24/2024 14:02:47 - INFO - __main__ -   ***** Running ANN Embedding Inference *****
11/24/2024 14:02:47 - INFO - __main__ -     Batch size = 2048
Inferencing: 0it [00:00, ?it/s]Inferencing: 2it [00:04,  2.06s/it]
11/24/2024 14:02:51 - INFO - __main__ -   merging embeddings
11/24/2024 14:02:52 - INFO - __main__ -   ***** inference of passages *****
884182 -1
884182 -1
11/24/2024 14:02:52 - INFO - __main__ -   ***** Running ANN Embedding Inference *****
11/24/2024 14:02:52 - INFO - __main__ -     Batch size = 2048
Inferencing: 0it [00:00, ?it/s]Inferencing: 0it [00:15, ?it/s]Inferencing: 3it [00:20,  6.99s/it]Inferencing: 4it [00:27,  6.98s/it]Inferencing: 5it [00:34,  6.95s/it]Inferencing: 6it [00:41,  6.94s/it]Inferencing: 7it [00:48,  6.92s/it]Inferencing: 8it [00:55,  6.91s/it]Inferencing: 9it [01:02,  6.93s/it]Inferencing: 10it [01:09,  6.92s/it]Inferencing: 11it [01:16,  6.91s/it]Inferencing: 12it [01:23,  6.91s/it]Inferencing: 13it [01:30,  6.92s/it]Inferencing: 14it [01:37,  6.91s/it]Inferencing: 15it [01:43,  6.91s/it]Inferencing: 16it [01:50,  6.90s/it]Inferencing: 17it [01:57,  6.91s/it]Inferencing: 18it [02:04,  6.94s/it]Inferencing: 19it [02:11,  6.93s/it]Inferencing: 20it [02:18,  6.92s/it]Inferencing: 21it [02:25,  6.92s/it]Inferencing: 22it [02:32,  6.93s/it]Inferencing: 23it [02:39,  6.93s/it]Inferencing: 24it [02:46,  6.92s/it]Inferencing: 25it [02:53,  6.91s/it]Inferencing: 26it [03:00,  6.91s/it]Inferencing: 27it [03:06,  6.93s/it]Inferencing: 28it [03:13,  6.91s/it]Inferencing: 29it [03:20,  6.90s/it]Inferencing: 30it [03:27,  6.90s/it]Inferencing: 31it [03:34,  6.90s/it]Inferencing: 32it [03:41,  6.92s/it]Inferencing: 33it [03:48,  6.91s/it]Inferencing: 34it [03:55,  6.92s/it]Inferencing: 35it [04:02,  6.91s/it]Inferencing: 36it [04:09,  6.93s/it]Inferencing: 37it [04:16,  6.92s/it]Inferencing: 38it [04:23,  6.92s/it]Inferencing: 39it [04:29,  6.92s/it]Inferencing: 40it [04:36,  6.92s/it]Inferencing: 41it [04:43,  6.93s/it]Inferencing: 42it [04:50,  6.92s/it]Inferencing: 43it [04:57,  6.91s/it]Inferencing: 44it [05:04,  6.91s/it]Inferencing: 45it [05:11,  6.92s/it]Inferencing: 46it [05:18,  6.91s/it]Inferencing: 47it [05:25,  6.91s/it]Inferencing: 48it [05:32,  6.90s/it]Inferencing: 49it [05:38,  6.89s/it]Inferencing: 50it [05:45,  6.93s/it]Inferencing: 51it [05:52,  6.92s/it]Inferencing: 52it [05:59,  6.91s/it]Inferencing: 53it [06:06,  6.91s/it]Inferencing: 54it [06:13,  6.93s/it]Inferencing: 55it [06:20,  6.92s/it]Inferencing: 56it [06:27,  6.92s/it]Inferencing: 57it [06:34,  6.92s/it]Inferencing: 58it [06:41,  6.93s/it]Inferencing: 59it [06:48,  6.94s/it]Inferencing: 60it [06:55,  6.93s/it]Inferencing: 61it [07:02,  6.92s/it]Inferencing: 62it [07:09,  6.91s/it]Inferencing: 63it [07:15,  6.91s/it]Inferencing: 64it [07:22,  6.92s/it]Inferencing: 65it [07:29,  6.91s/it]Inferencing: 66it [07:36,  6.91s/it]Inferencing: 67it [07:43,  6.90s/it]Inferencing: 68it [07:50,  6.92s/it]Inferencing: 69it [07:57,  6.91s/it]Inferencing: 70it [08:04,  6.91s/it]Inferencing: 71it [08:11,  6.91s/it]Inferencing: 72it [08:18,  6.91s/it]Inferencing: 73it [08:25,  6.92s/it]Inferencing: 74it [08:31,  6.92s/it]Inferencing: 75it [08:38,  6.91s/it]Inferencing: 76it [08:45,  6.91s/it]Inferencing: 77it [08:52,  6.93s/it]Inferencing: 78it [08:59,  6.92s/it]Inferencing: 79it [09:06,  6.92s/it]Inferencing: 80it [09:13,  6.91s/it]Inferencing: 81it [09:20,  6.90s/it]Inferencing: 82it [09:27,  6.92s/it]Inferencing: 83it [09:34,  6.92s/it]Inferencing: 84it [09:41,  6.91s/it]Inferencing: 85it [09:47,  6.90s/it]Inferencing: 86it [09:54,  6.90s/it]Inferencing: 87it [10:01,  6.92s/it]Inferencing: 88it [10:08,  6.91s/it]Inferencing: 89it [10:15,  6.91s/it]Inferencing: 90it [10:22,  6.91s/it]Inferencing: 91it [10:29,  6.92s/it]Inferencing: 92it [10:36,  6.91s/it]Inferencing: 93it [10:43,  6.91s/it]Inferencing: 94it [10:50,  6.93s/it]Inferencing: 95it [10:57,  6.93s/it]Inferencing: 96it [11:04,  6.93s/it]Inferencing: 97it [11:11,  6.93s/it]Inferencing: 98it [11:17,  6.93s/it]Inferencing: 99it [11:24,  6.92s/it]Inferencing: 100it [11:31,  6.93s/it]Inferencing: 101it [11:38,  6.91s/it]Inferencing: 102it [11:45,  6.91s/it]Inferencing: 103it [11:52,  6.91s/it]Inferencing: 104it [11:59,  6.91s/it]Inferencing: 105it [12:06,  6.92s/it]Inferencing: 106it [12:13,  6.91s/it]Inferencing: 107it [12:20,  6.91s/it]Inferencing: 108it [12:27,  6.91s/it]Inferencing: 109it [12:34,  6.93s/it]Inferencing: 110it [12:40,  6.92s/it]Inferencing: 111it [12:47,  6.92s/it]Inferencing: 112it [12:54,  6.92s/it]Inferencing: 113it [13:01,  6.91s/it]Inferencing: 114it [13:08,  6.93s/it]Inferencing: 115it [13:15,  6.92s/it]Inferencing: 116it [13:22,  6.92s/it]Inferencing: 117it [13:29,  6.91s/it]Inferencing: 118it [13:36,  6.91s/it]Inferencing: 119it [13:43,  6.92s/it]Inferencing: 120it [13:50,  6.91s/it]Inferencing: 121it [13:57,  6.91s/it]Inferencing: 122it [14:03,  6.91s/it]Inferencing: 123it [14:10,  6.92s/it]Inferencing: 124it [14:17,  6.91s/it]Inferencing: 125it [14:24,  6.90s/it]Inferencing: 126it [14:31,  6.90s/it]Inferencing: 127it [14:38,  6.91s/it]Inferencing: 128it [14:45,  6.93s/it]Inferencing: 129it [14:52,  6.92s/it]Inferencing: 130it [14:59,  6.91s/it]Inferencing: 131it [15:06,  6.91s/it]Inferencing: 132it [15:13,  6.93s/it]Inferencing: 133it [15:20,  6.92s/it]Inferencing: 134it [15:26,  6.92s/it]Inferencing: 135it [15:33,  6.91s/it]Inferencing: 136it [15:40,  6.91s/it]Inferencing: 137it [15:47,  6.91s/it]Inferencing: 138it [15:54,  6.91s/it]Inferencing: 139it [16:01,  6.90s/it]Inferencing: 140it [16:08,  6.90s/it]Inferencing: 141it [16:15,  6.91s/it]Inferencing: 142it [16:22,  6.92s/it]Inferencing: 143it [16:29,  6.91s/it]Inferencing: 144it [16:36,  6.91s/it]Inferencing: 145it [16:42,  6.90s/it]Inferencing: 146it [16:49,  6.93s/it]Inferencing: 147it [16:56,  6.92s/it]Inferencing: 148it [17:03,  6.91s/it]Inferencing: 149it [17:10,  6.91s/it]Inferencing: 150it [17:17,  6.91s/it]Inferencing: 151it [17:24,  6.93s/it]Inferencing: 152it [17:31,  6.93s/it]Inferencing: 153it [17:38,  6.92s/it]Inferencing: 154it [17:45,  6.92s/it]Inferencing: 155it [17:52,  6.93s/it]Inferencing: 156it [17:59,  6.92s/it]Inferencing: 157it [18:05,  6.91s/it]Inferencing: 158it [18:12,  6.90s/it]Inferencing: 159it [18:19,  6.90s/it]Inferencing: 160it [18:26,  6.92s/it]Inferencing: 161it [18:33,  6.91s/it]Inferencing: 162it [18:40,  6.91s/it]Inferencing: 163it [18:47,  6.90s/it]Inferencing: 164it [18:54,  6.90s/it]Inferencing: 165it [19:01,  6.93s/it]Inferencing: 166it [19:08,  6.92s/it]Inferencing: 167it [19:15,  6.92s/it]Inferencing: 168it [19:21,  6.91s/it]Inferencing: 169it [19:28,  6.93s/it]Inferencing: 170it [19:35,  6.92s/it]Inferencing: 171it [19:42,  6.92s/it]Inferencing: 172it [19:49,  6.92s/it]Inferencing: 173it [19:56,  6.91s/it]Inferencing: 174it [20:03,  6.92s/it]Inferencing: 175it [20:10,  6.92s/it]Inferencing: 176it [20:17,  6.91s/it]Inferencing: 177it [20:24,  6.91s/it]Inferencing: 178it [20:31,  6.92s/it]Inferencing: 179it [20:38,  6.91s/it]Inferencing: 180it [20:44,  6.90s/it]Inferencing: 181it [20:51,  6.90s/it]Inferencing: 182it [20:58,  6.90s/it]Inferencing: 183it [21:05,  6.92s/it]Inferencing: 184it [21:12,  6.91s/it]Inferencing: 185it [21:19,  6.91s/it]Inferencing: 186it [21:26,  6.91s/it]Inferencing: 187it [21:33,  6.93s/it]Inferencing: 188it [21:40,  6.92s/it]Inferencing: 189it [21:47,  6.92s/it]Inferencing: 190it [21:54,  6.92s/it]Inferencing: 191it [22:01,  6.92s/it]Inferencing: 192it [22:07,  6.93s/it]Inferencing: 193it [22:14,  6.92s/it]Inferencing: 194it [22:21,  6.91s/it]Inferencing: 195it [22:28,  6.90s/it]Inferencing: 196it [22:35,  6.90s/it]Inferencing: 197it [22:42,  6.91s/it]Inferencing: 198it [22:49,  6.90s/it]Inferencing: 199it [22:56,  6.91s/it]Inferencing: 200it [23:03,  6.90s/it]Inferencing: 201it [23:10,  6.92s/it]Inferencing: 202it [23:17,  6.94s/it]Inferencing: 203it [23:23,  6.93s/it]Inferencing: 204it [23:30,  6.92s/it]Inferencing: 205it [23:37,  6.91s/it]Inferencing: 206it [23:44,  6.93s/it]Inferencing: 207it [23:51,  6.95s/it]Inferencing: 208it [23:58,  6.94s/it]Inferencing: 209it [24:05,  6.93s/it]Inferencing: 210it [24:12,  6.94s/it]Inferencing: 211it [24:19,  6.93s/it]Inferencing: 212it [24:26,  6.92s/it]Inferencing: 213it [24:33,  6.91s/it]Inferencing: 214it [24:40,  6.90s/it]Inferencing: 215it [24:47,  6.92s/it]Inferencing: 216it [24:53,  6.63s/it]Inferencing: 216it [24:53,  6.91s/it]
11/24/2024 14:27:45 - INFO - __main__ -   merging embeddings
11/24/2024 14:27:53 - INFO - __main__ -   ***** Done passage inference *****
11/24/2024 14:27:53 - INFO - __main__ -   ***** inference of train query *****
502939 -1
502939 -1
11/24/2024 14:27:53 - INFO - __main__ -   ***** Running ANN Embedding Inference *****
11/24/2024 14:27:53 - INFO - __main__ -     Batch size = 2048
Inferencing: 0it [00:00, ?it/s]Inferencing: 0it [00:14, ?it/s]Inferencing: 7it [00:16,  2.31s/it]Inferencing: 8it [00:18,  2.32s/it]Inferencing: 9it [00:20,  2.31s/it]Inferencing: 10it [00:23,  2.30s/it]Inferencing: 11it [00:25,  2.31s/it]Inferencing: 12it [00:27,  2.30s/it]Inferencing: 13it [00:30,  2.31s/it]Inferencing: 14it [00:32,  2.30s/it]Inferencing: 15it [00:34,  2.30s/it]Inferencing: 16it [00:36,  2.30s/it]Inferencing: 17it [00:39,  2.31s/it]Inferencing: 18it [00:41,  2.31s/it]Inferencing: 19it [00:43,  2.30s/it]Inferencing: 20it [00:46,  2.30s/it]Inferencing: 21it [00:48,  2.31s/it]Inferencing: 22it [00:50,  2.31s/it]Inferencing: 23it [00:53,  2.31s/it]Inferencing: 24it [00:55,  2.30s/it]Inferencing: 25it [00:57,  2.30s/it]Inferencing: 26it [00:59,  2.29s/it]Inferencing: 27it [01:02,  2.30s/it]Inferencing: 28it [01:04,  2.30s/it]Inferencing: 29it [01:06,  2.30s/it]Inferencing: 30it [01:09,  2.30s/it]Inferencing: 31it [01:11,  2.31s/it]Inferencing: 32it [01:13,  2.31s/it]Inferencing: 33it [01:16,  2.30s/it]Inferencing: 34it [01:18,  2.30s/it]Inferencing: 35it [01:20,  2.30s/it]Inferencing: 36it [01:23,  2.31s/it]Inferencing: 37it [01:25,  2.31s/it]Inferencing: 38it [01:27,  2.30s/it]Inferencing: 39it [01:29,  2.30s/it]Inferencing: 40it [01:32,  2.32s/it]Inferencing: 41it [01:34,  2.31s/it]Inferencing: 42it [01:36,  2.30s/it]Inferencing: 43it [01:39,  2.30s/it]Inferencing: 44it [01:41,  2.30s/it]Inferencing: 45it [01:43,  2.31s/it]Inferencing: 46it [01:46,  2.31s/it]Inferencing: 47it [01:48,  2.31s/it]Inferencing: 48it [01:50,  2.30s/it]Inferencing: 49it [01:52,  2.30s/it]Inferencing: 50it [01:55,  2.31s/it]Inferencing: 51it [01:57,  2.30s/it]Inferencing: 52it [01:59,  2.30s/it]Inferencing: 53it [02:02,  2.30s/it]Inferencing: 54it [02:04,  2.32s/it]Inferencing: 55it [02:06,  2.31s/it]Inferencing: 56it [02:09,  2.31s/it]Inferencing: 57it [02:11,  2.30s/it]Inferencing: 58it [02:13,  2.30s/it]Inferencing: 59it [02:16,  2.32s/it]Inferencing: 60it [02:18,  2.31s/it]Inferencing: 61it [02:20,  2.30s/it]Inferencing: 62it [02:22,  2.30s/it]Inferencing: 63it [02:25,  2.31s/it]Inferencing: 64it [02:27,  2.31s/it]Inferencing: 65it [02:29,  2.30s/it]Inferencing: 66it [02:32,  2.30s/it]Inferencing: 67it [02:34,  2.30s/it]Inferencing: 68it [02:36,  2.30s/it]Inferencing: 69it [02:39,  2.31s/it]Inferencing: 70it [02:41,  2.30s/it]Inferencing: 71it [02:43,  2.30s/it]Inferencing: 72it [02:45,  2.31s/it]Inferencing: 73it [02:48,  2.30s/it]Inferencing: 74it [02:50,  2.31s/it]Inferencing: 75it [02:52,  2.30s/it]Inferencing: 76it [02:55,  2.30s/it]Inferencing: 77it [02:57,  2.31s/it]Inferencing: 78it [02:59,  2.31s/it]Inferencing: 79it [03:02,  2.31s/it]Inferencing: 80it [03:04,  2.30s/it]Inferencing: 81it [03:06,  2.30s/it]Inferencing: 82it [03:09,  2.31s/it]Inferencing: 83it [03:11,  2.31s/it]Inferencing: 84it [03:13,  2.31s/it]Inferencing: 85it [03:15,  2.30s/it]Inferencing: 86it [03:18,  2.31s/it]Inferencing: 87it [03:20,  2.31s/it]Inferencing: 88it [03:22,  2.31s/it]Inferencing: 89it [03:25,  2.30s/it]Inferencing: 90it [03:27,  2.30s/it]Inferencing: 91it [03:29,  2.31s/it]Inferencing: 92it [03:32,  2.30s/it]Inferencing: 93it [03:34,  2.31s/it]Inferencing: 94it [03:36,  2.30s/it]Inferencing: 95it [03:39,  2.31s/it]Inferencing: 96it [03:41,  2.31s/it]Inferencing: 97it [03:43,  2.30s/it]Inferencing: 98it [03:45,  2.30s/it]Inferencing: 99it [03:48,  2.30s/it]Inferencing: 100it [03:50,  2.31s/it]Inferencing: 101it [03:52,  2.30s/it]Inferencing: 102it [03:55,  2.31s/it]Inferencing: 103it [03:57,  2.30s/it]Inferencing: 104it [03:59,  2.30s/it]Inferencing: 105it [04:02,  2.31s/it]Inferencing: 106it [04:04,  2.31s/it]Inferencing: 107it [04:06,  2.31s/it]Inferencing: 108it [04:08,  2.30s/it]Inferencing: 109it [04:11,  2.31s/it]Inferencing: 110it [04:13,  2.31s/it]Inferencing: 111it [04:15,  2.30s/it]Inferencing: 112it [04:18,  2.30s/it]Inferencing: 113it [04:20,  2.30s/it]Inferencing: 114it [04:22,  2.31s/it]Inferencing: 115it [04:25,  2.30s/it]Inferencing: 116it [04:27,  2.30s/it]Inferencing: 117it [04:29,  2.30s/it]Inferencing: 118it [04:32,  2.31s/it]Inferencing: 119it [04:34,  2.30s/it]Inferencing: 120it [04:36,  2.30s/it]Inferencing: 121it [04:38,  2.30s/it]Inferencing: 122it [04:41,  2.30s/it]Inferencing: 123it [04:43,  2.16s/it]Inferencing: 123it [04:43,  2.30s/it]
11/24/2024 14:32:36 - INFO - __main__ -   merging embeddings
Inference Time -  4.301795244216919 1501.3146059513092 290.30112385749817
Inference Time -  4.293214559555054 1501.3064367771149 290.33314752578735
11/24/2024 14:32:45 - INFO - __main__ -   ***** Done ANN Index *****
Indexing Time -  1.4159424304962158
Search FAISS TOP K
0 th batch is processing.. out of 1005
1 th batch is processing.. out of 1005
2 th batch is processing.. out of 1005
3 th batch is processing.. out of 1005
4 th batch is processing.. out of 1005
5 th batch is processing.. out of 1005
6 th batch is processing.. out of 1005
7 th batch is processing.. out of 1005
8 th batch is processing.. out of 1005
9 th batch is processing.. out of 1005
10 th batch is processing.. out of 1005
11 th batch is processing.. out of 1005
12 th batch is processing.. out of 1005
13 th batch is processing.. out of 1005
14 th batch is processing.. out of 1005
15 th batch is processing.. out of 1005
16 th batch is processing.. out of 1005
17 th batch is processing.. out of 1005
18 th batch is processing.. out of 1005
19 th batch is processing.. out of 1005
20 th batch is processing.. out of 1005
21 th batch is processing.. out of 1005
22 th batch is processing.. out of 1005
23 th batch is processing.. out of 1005
24 th batch is processing.. out of 1005
25 th batch is processing.. out of 1005
26 th batch is processing.. out of 1005
27 th batch is processing.. out of 1005
28 th batch is processing.. out of 1005
29 th batch is processing.. out of 1005
30 th batch is processing.. out of 1005
31 th batch is processing.. out of 1005
32 th batch is processing.. out of 1005
33 th batch is processing.. out of 1005
34 th batch is processing.. out of 1005
35 th batch is processing.. out of 1005
36 th batch is processing.. out of 1005
37 th batch is processing.. out of 1005
38 th batch is processing.. out of 1005
39 th batch is processing.. out of 1005
40 th batch is processing.. out of 1005
41 th batch is processing.. out of 1005
42 th batch is processing.. out of 1005
43 th batch is processing.. out of 1005
44 th batch is processing.. out of 1005
45 th batch is processing.. out of 1005
46 th batch is processing.. out of 1005
47 th batch is processing.. out of 1005
48 th batch is processing.. out of 1005
49 th batch is processing.. out of 1005
50 th batch is processing.. out of 1005
51 th batch is processing.. out of 1005
52 th batch is processing.. out of 1005
53 th batch is processing.. out of 1005
54 th batch is processing.. out of 1005
55 th batch is processing.. out of 1005
56 th batch is processing.. out of 1005
57 th batch is processing.. out of 1005
58 th batch is processing.. out of 1005
59 th batch is processing.. out of 1005
60 th batch is processing.. out of 1005
61 th batch is processing.. out of 1005
62 th batch is processing.. out of 1005
63 th batch is processing.. out of 1005
64 th batch is processing.. out of 1005
65 th batch is processing.. out of 1005
66 th batch is processing.. out of 1005
67 th batch is processing.. out of 1005
68 th batch is processing.. out of 1005
69 th batch is processing.. out of 1005
70 th batch is processing.. out of 1005
71 th batch is processing.. out of 1005
72 th batch is processing.. out of 1005
73 th batch is processing.. out of 1005
74 th batch is processing.. out of 1005
75 th batch is processing.. out of 1005
76 th batch is processing.. out of 1005
77 th batch is processing.. out of 1005
78 th batch is processing.. out of 1005
79 th batch is processing.. out of 1005
80 th batch is processing.. out of 1005
81 th batch is processing.. out of 1005
82 th batch is processing.. out of 1005
83 th batch is processing.. out of 1005
84 th batch is processing.. out of 1005
85 th batch is processing.. out of 1005
86 th batch is processing.. out of 1005
87 th batch is processing.. out of 1005
88 th batch is processing.. out of 1005
89 th batch is processing.. out of 1005
90 th batch is processing.. out of 1005
91 th batch is processing.. out of 1005
92 th batch is processing.. out of 1005
93 th batch is processing.. out of 1005
94 th batch is processing.. out of 1005
95 th batch is processing.. out of 1005
96 th batch is processing.. out of 1005
97 th batch is processing.. out of 1005
98 th batch is processing.. out of 1005
99 th batch is processing.. out of 1005
100 th batch is processing.. out of 1005
101 th batch is processing.. out of 1005
102 th batch is processing.. out of 1005
103 th batch is processing.. out of 1005
104 th batch is processing.. out of 1005
105 th batch is processing.. out of 1005
106 th batch is processing.. out of 1005
107 th batch is processing.. out of 1005
108 th batch is processing.. out of 1005
109 th batch is processing.. out of 1005
110 th batch is processing.. out of 1005
111 th batch is processing.. out of 1005
112 th batch is processing.. out of 1005
113 th batch is processing.. out of 1005
114 th batch is processing.. out of 1005
115 th batch is processing.. out of 1005
116 th batch is processing.. out of 1005
117 th batch is processing.. out of 1005
118 th batch is processing.. out of 1005
119 th batch is processing.. out of 1005
120 th batch is processing.. out of 1005
121 th batch is processing.. out of 1005
122 th batch is processing.. out of 1005
123 th batch is processing.. out of 1005
124 th batch is processing.. out of 1005
125 th batch is processing.. out of 1005
126 th batch is processing.. out of 1005
127 th batch is processing.. out of 1005
128 th batch is processing.. out of 1005
129 th batch is processing.. out of 1005
130 th batch is processing.. out of 1005
131 th batch is processing.. out of 1005
132 th batch is processing.. out of 1005
133 th batch is processing.. out of 1005
134 th batch is processing.. out of 1005
135 th batch is processing.. out of 1005
136 th batch is processing.. out of 1005
137 th batch is processing.. out of 1005
138 th batch is processing.. out of 1005
139 th batch is processing.. out of 1005
140 th batch is processing.. out of 1005
141 th batch is processing.. out of 1005
142 th batch is processing.. out of 1005
143 th batch is processing.. out of 1005
144 th batch is processing.. out of 1005
145 th batch is processing.. out of 1005
146 th batch is processing.. out of 1005
147 th batch is processing.. out of 1005
148 th batch is processing.. out of 1005
149 th batch is processing.. out of 1005
150 th batch is processing.. out of 1005
151 th batch is processing.. out of 1005
152 th batch is processing.. out of 1005
153 th batch is processing.. out of 1005
154 th batch is processing.. out of 1005
155 th batch is processing.. out of 1005
156 th batch is processing.. out of 1005
157 th batch is processing.. out of 1005
158 th batch is processing.. out of 1005
159 th batch is processing.. out of 1005
160 th batch is processing.. out of 1005
161 th batch is processing.. out of 1005
162 th batch is processing.. out of 1005
163 th batch is processing.. out of 1005
164 th batch is processing.. out of 1005
165 th batch is processing.. out of 1005
166 th batch is processing.. out of 1005
167 th batch is processing.. out of 1005
168 th batch is processing.. out of 1005
169 th batch is processing.. out of 1005
170 th batch is processing.. out of 1005
171 th batch is processing.. out of 1005
172 th batch is processing.. out of 1005
173 th batch is processing.. out of 1005
174 th batch is processing.. out of 1005
175 th batch is processing.. out of 1005
176 th batch is processing.. out of 1005
177 th batch is processing.. out of 1005
178 th batch is processing.. out of 1005
179 th batch is processing.. out of 1005
180 th batch is processing.. out of 1005
181 th batch is processing.. out of 1005
182 th batch is processing.. out of 1005
183 th batch is processing.. out of 1005
184 th batch is processing.. out of 1005
185 th batch is processing.. out of 1005
186 th batch is processing.. out of 1005
187 th batch is processing.. out of 1005
188 th batch is processing.. out of 1005
189 th batch is processing.. out of 1005
190 th batch is processing.. out of 1005
191 th batch is processing.. out of 1005
192 th batch is processing.. out of 1005
193 th batch is processing.. out of 1005
194 th batch is processing.. out of 1005
195 th batch is processing.. out of 1005
196 th batch is processing.. out of 1005
197 th batch is processing.. out of 1005
198 th batch is processing.. out of 1005
199 th batch is processing.. out of 1005
200 th batch is processing.. out of 1005
201 th batch is processing.. out of 1005
202 th batch is processing.. out of 1005
203 th batch is processing.. out of 1005
204 th batch is processing.. out of 1005
205 th batch is processing.. out of 1005
206 th batch is processing.. out of 1005
207 th batch is processing.. out of 1005
208 th batch is processing.. out of 1005
209 th batch is processing.. out of 1005
210 th batch is processing.. out of 1005
211 th batch is processing.. out of 1005
212 th batch is processing.. out of 1005
213 th batch is processing.. out of 1005
214 th batch is processing.. out of 1005
215 th batch is processing.. out of 1005
216 th batch is processing.. out of 1005
217 th batch is processing.. out of 1005
218 th batch is processing.. out of 1005
219 th batch is processing.. out of 1005
220 th batch is processing.. out of 1005
221 th batch is processing.. out of 1005
222 th batch is processing.. out of 1005
223 th batch is processing.. out of 1005
224 th batch is processing.. out of 1005
225 th batch is processing.. out of 1005
226 th batch is processing.. out of 1005
227 th batch is processing.. out of 1005
228 th batch is processing.. out of 1005
229 th batch is processing.. out of 1005
230 th batch is processing.. out of 1005
231 th batch is processing.. out of 1005
232 th batch is processing.. out of 1005
233 th batch is processing.. out of 1005
234 th batch is processing.. out of 1005
235 th batch is processing.. out of 1005
236 th batch is processing.. out of 1005
237 th batch is processing.. out of 1005
238 th batch is processing.. out of 1005
239 th batch is processing.. out of 1005
240 th batch is processing.. out of 1005
241 th batch is processing.. out of 1005
242 th batch is processing.. out of 1005
243 th batch is processing.. out of 1005
244 th batch is processing.. out of 1005
245 th batch is processing.. out of 1005
246 th batch is processing.. out of 1005
247 th batch is processing.. out of 1005
248 th batch is processing.. out of 1005
249 th batch is processing.. out of 1005
250 th batch is processing.. out of 1005
251 th batch is processing.. out of 1005
252 th batch is processing.. out of 1005
253 th batch is processing.. out of 1005
254 th batch is processing.. out of 1005
255 th batch is processing.. out of 1005
256 th batch is processing.. out of 1005
257 th batch is processing.. out of 1005
258 th batch is processing.. out of 1005
259 th batch is processing.. out of 1005
260 th batch is processing.. out of 1005
261 th batch is processing.. out of 1005
262 th batch is processing.. out of 1005
263 th batch is processing.. out of 1005
264 th batch is processing.. out of 1005
265 th batch is processing.. out of 1005
266 th batch is processing.. out of 1005
267 th batch is processing.. out of 1005
268 th batch is processing.. out of 1005
269 th batch is processing.. out of 1005
270 th batch is processing.. out of 1005
271 th batch is processing.. out of 1005
272 th batch is processing.. out of 1005
273 th batch is processing.. out of 1005
274 th batch is processing.. out of 1005
275 th batch is processing.. out of 1005
276 th batch is processing.. out of 1005
277 th batch is processing.. out of 1005
278 th batch is processing.. out of 1005
279 th batch is processing.. out of 1005
280 th batch is processing.. out of 1005
281 th batch is processing.. out of 1005
282 th batch is processing.. out of 1005
283 th batch is processing.. out of 1005
284 th batch is processing.. out of 1005
285 th batch is processing.. out of 1005
286 th batch is processing.. out of 1005
287 th batch is processing.. out of 1005
288 th batch is processing.. out of 1005
289 th batch is processing.. out of 1005
290 th batch is processing.. out of 1005
291 th batch is processing.. out of 1005
292 th batch is processing.. out of 1005
293 th batch is processing.. out of 1005
294 th batch is processing.. out of 1005
295 th batch is processing.. out of 1005
296 th batch is processing.. out of 1005
297 th batch is processing.. out of 1005
298 th batch is processing.. out of 1005
299 th batch is processing.. out of 1005
300 th batch is processing.. out of 1005
301 th batch is processing.. out of 1005
302 th batch is processing.. out of 1005
303 th batch is processing.. out of 1005
304 th batch is processing.. out of 1005
305 th batch is processing.. out of 1005
306 th batch is processing.. out of 1005
307 th batch is processing.. out of 1005
308 th batch is processing.. out of 1005
309 th batch is processing.. out of 1005
310 th batch is processing.. out of 1005
311 th batch is processing.. out of 1005
312 th batch is processing.. out of 1005
313 th batch is processing.. out of 1005
314 th batch is processing.. out of 1005
315 th batch is processing.. out of 1005
316 th batch is processing.. out of 1005
317 th batch is processing.. out of 1005
318 th batch is processing.. out of 1005
319 th batch is processing.. out of 1005
320 th batch is processing.. out of 1005
321 th batch is processing.. out of 1005
322 th batch is processing.. out of 1005
323 th batch is processing.. out of 1005
324 th batch is processing.. out of 1005
325 th batch is processing.. out of 1005
326 th batch is processing.. out of 1005
327 th batch is processing.. out of 1005
328 th batch is processing.. out of 1005
329 th batch is processing.. out of 1005
330 th batch is processing.. out of 1005
331 th batch is processing.. out of 1005
332 th batch is processing.. out of 1005
333 th batch is processing.. out of 1005
334 th batch is processing.. out of 1005
335 th batch is processing.. out of 1005
336 th batch is processing.. out of 1005
337 th batch is processing.. out of 1005
338 th batch is processing.. out of 1005
339 th batch is processing.. out of 1005
340 th batch is processing.. out of 1005
341 th batch is processing.. out of 1005
342 th batch is processing.. out of 1005
343 th batch is processing.. out of 1005
344 th batch is processing.. out of 1005
345 th batch is processing.. out of 1005
346 th batch is processing.. out of 1005
347 th batch is processing.. out of 1005
348 th batch is processing.. out of 1005
349 th batch is processing.. out of 1005
350 th batch is processing.. out of 1005
351 th batch is processing.. out of 1005
352 th batch is processing.. out of 1005
353 th batch is processing.. out of 1005
354 th batch is processing.. out of 1005
355 th batch is processing.. out of 1005
356 th batch is processing.. out of 1005
357 th batch is processing.. out of 1005
358 th batch is processing.. out of 1005
359 th batch is processing.. out of 1005
360 th batch is processing.. out of 1005
361 th batch is processing.. out of 1005
362 th batch is processing.. out of 1005
363 th batch is processing.. out of 1005
364 th batch is processing.. out of 1005
365 th batch is processing.. out of 1005
366 th batch is processing.. out of 1005
367 th batch is processing.. out of 1005
368 th batch is processing.. out of 1005
369 th batch is processing.. out of 1005
370 th batch is processing.. out of 1005
371 th batch is processing.. out of 1005
372 th batch is processing.. out of 1005
373 th batch is processing.. out of 1005
374 th batch is processing.. out of 1005
375 th batch is processing.. out of 1005
376 th batch is processing.. out of 1005
377 th batch is processing.. out of 1005
378 th batch is processing.. out of 1005
379 th batch is processing.. out of 1005
380 th batch is processing.. out of 1005
381 th batch is processing.. out of 1005
382 th batch is processing.. out of 1005
383 th batch is processing.. out of 1005
384 th batch is processing.. out of 1005
385 th batch is processing.. out of 1005
386 th batch is processing.. out of 1005
387 th batch is processing.. out of 1005
388 th batch is processing.. out of 1005
389 th batch is processing.. out of 1005
390 th batch is processing.. out of 1005
391 th batch is processing.. out of 1005
392 th batch is processing.. out of 1005
393 th batch is processing.. out of 1005
394 th batch is processing.. out of 1005
395 th batch is processing.. out of 1005
396 th batch is processing.. out of 1005
397 th batch is processing.. out of 1005
398 th batch is processing.. out of 1005
399 th batch is processing.. out of 1005
400 th batch is processing.. out of 1005
401 th batch is processing.. out of 1005
402 th batch is processing.. out of 1005
403 th batch is processing.. out of 1005
404 th batch is processing.. out of 1005
405 th batch is processing.. out of 1005
406 th batch is processing.. out of 1005
407 th batch is processing.. out of 1005
408 th batch is processing.. out of 1005
409 th batch is processing.. out of 1005
410 th batch is processing.. out of 1005
411 th batch is processing.. out of 1005
412 th batch is processing.. out of 1005
413 th batch is processing.. out of 1005
414 th batch is processing.. out of 1005
415 th batch is processing.. out of 1005
416 th batch is processing.. out of 1005
417 th batch is processing.. out of 1005
418 th batch is processing.. out of 1005
419 th batch is processing.. out of 1005
420 th batch is processing.. out of 1005
421 th batch is processing.. out of 1005
422 th batch is processing.. out of 1005
423 th batch is processing.. out of 1005
424 th batch is processing.. out of 1005
425 th batch is processing.. out of 1005
426 th batch is processing.. out of 1005
427 th batch is processing.. out of 1005
428 th batch is processing.. out of 1005
429 th batch is processing.. out of 1005
430 th batch is processing.. out of 1005
431 th batch is processing.. out of 1005
432 th batch is processing.. out of 1005
433 th batch is processing.. out of 1005
434 th batch is processing.. out of 1005
435 th batch is processing.. out of 1005
436 th batch is processing.. out of 1005
437 th batch is processing.. out of 1005
438 th batch is processing.. out of 1005
439 th batch is processing.. out of 1005
440 th batch is processing.. out of 1005
441 th batch is processing.. out of 1005
442 th batch is processing.. out of 1005
443 th batch is processing.. out of 1005
444 th batch is processing.. out of 1005
445 th batch is processing.. out of 1005
446 th batch is processing.. out of 1005
447 th batch is processing.. out of 1005
448 th batch is processing.. out of 1005
449 th batch is processing.. out of 1005
450 th batch is processing.. out of 1005
451 th batch is processing.. out of 1005
452 th batch is processing.. out of 1005
453 th batch is processing.. out of 1005
454 th batch is processing.. out of 1005
455 th batch is processing.. out of 1005
456 th batch is processing.. out of 1005
457 th batch is processing.. out of 1005
458 th batch is processing.. out of 1005
459 th batch is processing.. out of 1005
460 th batch is processing.. out of 1005
461 th batch is processing.. out of 1005
462 th batch is processing.. out of 1005
463 th batch is processing.. out of 1005
464 th batch is processing.. out of 1005
465 th batch is processing.. out of 1005
466 th batch is processing.. out of 1005
467 th batch is processing.. out of 1005
468 th batch is processing.. out of 1005
469 th batch is processing.. out of 1005
470 th batch is processing.. out of 1005
471 th batch is processing.. out of 1005
472 th batch is processing.. out of 1005
473 th batch is processing.. out of 1005
474 th batch is processing.. out of 1005
475 th batch is processing.. out of 1005
476 th batch is processing.. out of 1005
477 th batch is processing.. out of 1005
478 th batch is processing.. out of 1005
479 th batch is processing.. out of 1005
480 th batch is processing.. out of 1005
481 th batch is processing.. out of 1005
482 th batch is processing.. out of 1005
483 th batch is processing.. out of 1005
484 th batch is processing.. out of 1005
485 th batch is processing.. out of 1005
486 th batch is processing.. out of 1005
487 th batch is processing.. out of 1005
488 th batch is processing.. out of 1005
489 th batch is processing.. out of 1005
490 th batch is processing.. out of 1005
491 th batch is processing.. out of 1005
492 th batch is processing.. out of 1005
493 th batch is processing.. out of 1005
494 th batch is processing.. out of 1005
495 th batch is processing.. out of 1005
496 th batch is processing.. out of 1005
497 th batch is processing.. out of 1005
498 th batch is processing.. out of 1005
499 th batch is processing.. out of 1005
500 th batch is processing.. out of 1005
501 th batch is processing.. out of 1005
502 th batch is processing.. out of 1005
503 th batch is processing.. out of 1005
504 th batch is processing.. out of 1005
505 th batch is processing.. out of 1005
506 th batch is processing.. out of 1005
507 th batch is processing.. out of 1005
508 th batch is processing.. out of 1005
509 th batch is processing.. out of 1005
510 th batch is processing.. out of 1005
511 th batch is processing.. out of 1005
512 th batch is processing.. out of 1005
513 th batch is processing.. out of 1005
514 th batch is processing.. out of 1005
515 th batch is processing.. out of 1005
516 th batch is processing.. out of 1005
517 th batch is processing.. out of 1005
518 th batch is processing.. out of 1005
519 th batch is processing.. out of 1005
520 th batch is processing.. out of 1005
521 th batch is processing.. out of 1005
522 th batch is processing.. out of 1005
523 th batch is processing.. out of 1005
524 th batch is processing.. out of 1005
525 th batch is processing.. out of 1005
526 th batch is processing.. out of 1005
527 th batch is processing.. out of 1005
528 th batch is processing.. out of 1005
529 th batch is processing.. out of 1005
530 th batch is processing.. out of 1005
531 th batch is processing.. out of 1005
532 th batch is processing.. out of 1005
533 th batch is processing.. out of 1005
534 th batch is processing.. out of 1005
535 th batch is processing.. out of 1005
536 th batch is processing.. out of 1005
537 th batch is processing.. out of 1005
538 th batch is processing.. out of 1005
539 th batch is processing.. out of 1005
540 th batch is processing.. out of 1005
541 th batch is processing.. out of 1005
542 th batch is processing.. out of 1005
543 th batch is processing.. out of 1005
544 th batch is processing.. out of 1005
545 th batch is processing.. out of 1005
546 th batch is processing.. out of 1005
547 th batch is processing.. out of 1005
548 th batch is processing.. out of 1005
549 th batch is processing.. out of 1005
550 th batch is processing.. out of 1005
551 th batch is processing.. out of 1005
552 th batch is processing.. out of 1005
553 th batch is processing.. out of 1005
554 th batch is processing.. out of 1005
555 th batch is processing.. out of 1005
556 th batch is processing.. out of 1005
557 th batch is processing.. out of 1005
558 th batch is processing.. out of 1005
559 th batch is processing.. out of 1005
560 th batch is processing.. out of 1005
561 th batch is processing.. out of 1005
562 th batch is processing.. out of 1005
563 th batch is processing.. out of 1005
564 th batch is processing.. out of 1005
565 th batch is processing.. out of 1005
566 th batch is processing.. out of 1005
567 th batch is processing.. out of 1005
568 th batch is processing.. out of 1005
569 th batch is processing.. out of 1005
570 th batch is processing.. out of 1005
571 th batch is processing.. out of 1005
572 th batch is processing.. out of 1005
573 th batch is processing.. out of 1005
574 th batch is processing.. out of 1005
575 th batch is processing.. out of 1005
576 th batch is processing.. out of 1005
577 th batch is processing.. out of 1005
578 th batch is processing.. out of 1005
579 th batch is processing.. out of 1005
580 th batch is processing.. out of 1005
581 th batch is processing.. out of 1005
582 th batch is processing.. out of 1005
583 th batch is processing.. out of 1005
584 th batch is processing.. out of 1005
585 th batch is processing.. out of 1005
586 th batch is processing.. out of 1005
587 th batch is processing.. out of 1005
588 th batch is processing.. out of 1005
589 th batch is processing.. out of 1005
590 th batch is processing.. out of 1005
591 th batch is processing.. out of 1005
592 th batch is processing.. out of 1005
593 th batch is processing.. out of 1005
594 th batch is processing.. out of 1005
595 th batch is processing.. out of 1005
596 th batch is processing.. out of 1005
597 th batch is processing.. out of 1005
598 th batch is processing.. out of 1005
599 th batch is processing.. out of 1005
600 th batch is processing.. out of 1005
601 th batch is processing.. out of 1005
602 th batch is processing.. out of 1005
603 th batch is processing.. out of 1005
604 th batch is processing.. out of 1005
605 th batch is processing.. out of 1005
606 th batch is processing.. out of 1005
607 th batch is processing.. out of 1005
608 th batch is processing.. out of 1005
609 th batch is processing.. out of 1005
610 th batch is processing.. out of 1005
611 th batch is processing.. out of 1005
612 th batch is processing.. out of 1005
613 th batch is processing.. out of 1005
614 th batch is processing.. out of 1005
615 th batch is processing.. out of 1005
616 th batch is processing.. out of 1005
617 th batch is processing.. out of 1005
618 th batch is processing.. out of 1005
619 th batch is processing.. out of 1005
620 th batch is processing.. out of 1005
621 th batch is processing.. out of 1005
622 th batch is processing.. out of 1005
623 th batch is processing.. out of 1005
624 th batch is processing.. out of 1005
625 th batch is processing.. out of 1005
626 th batch is processing.. out of 1005
627 th batch is processing.. out of 1005
628 th batch is processing.. out of 1005
629 th batch is processing.. out of 1005
630 th batch is processing.. out of 1005
631 th batch is processing.. out of 1005
632 th batch is processing.. out of 1005
633 th batch is processing.. out of 1005
634 th batch is processing.. out of 1005
635 th batch is processing.. out of 1005
636 th batch is processing.. out of 1005
637 th batch is processing.. out of 1005
638 th batch is processing.. out of 1005
639 th batch is processing.. out of 1005
640 th batch is processing.. out of 1005
641 th batch is processing.. out of 1005
642 th batch is processing.. out of 1005
643 th batch is processing.. out of 1005
644 th batch is processing.. out of 1005
645 th batch is processing.. out of 1005
646 th batch is processing.. out of 1005
647 th batch is processing.. out of 1005
648 th batch is processing.. out of 1005
649 th batch is processing.. out of 1005
650 th batch is processing.. out of 1005
651 th batch is processing.. out of 1005
652 th batch is processing.. out of 1005
653 th batch is processing.. out of 1005
654 th batch is processing.. out of 1005
655 th batch is processing.. out of 1005
656 th batch is processing.. out of 1005
657 th batch is processing.. out of 1005
658 th batch is processing.. out of 1005
659 th batch is processing.. out of 1005
660 th batch is processing.. out of 1005
661 th batch is processing.. out of 1005
662 th batch is processing.. out of 1005
663 th batch is processing.. out of 1005
664 th batch is processing.. out of 1005
665 th batch is processing.. out of 1005
666 th batch is processing.. out of 1005
667 th batch is processing.. out of 1005
668 th batch is processing.. out of 1005
669 th batch is processing.. out of 1005
670 th batch is processing.. out of 1005
671 th batch is processing.. out of 1005
672 th batch is processing.. out of 1005
673 th batch is processing.. out of 1005
674 th batch is processing.. out of 1005
675 th batch is processing.. out of 1005
676 th batch is processing.. out of 1005
677 th batch is processing.. out of 1005
678 th batch is processing.. out of 1005
679 th batch is processing.. out of 1005
680 th batch is processing.. out of 1005
681 th batch is processing.. out of 1005
682 th batch is processing.. out of 1005
683 th batch is processing.. out of 1005
684 th batch is processing.. out of 1005
685 th batch is processing.. out of 1005
686 th batch is processing.. out of 1005
687 th batch is processing.. out of 1005
688 th batch is processing.. out of 1005
689 th batch is processing.. out of 1005
690 th batch is processing.. out of 1005
691 th batch is processing.. out of 1005
692 th batch is processing.. out of 1005
693 th batch is processing.. out of 1005
694 th batch is processing.. out of 1005
695 th batch is processing.. out of 1005
696 th batch is processing.. out of 1005
697 th batch is processing.. out of 1005
698 th batch is processing.. out of 1005
699 th batch is processing.. out of 1005
700 th batch is processing.. out of 1005
701 th batch is processing.. out of 1005
702 th batch is processing.. out of 1005
703 th batch is processing.. out of 1005
704 th batch is processing.. out of 1005
705 th batch is processing.. out of 1005
706 th batch is processing.. out of 1005
707 th batch is processing.. out of 1005
708 th batch is processing.. out of 1005
709 th batch is processing.. out of 1005
710 th batch is processing.. out of 1005
711 th batch is processing.. out of 1005
712 th batch is processing.. out of 1005
713 th batch is processing.. out of 1005
714 th batch is processing.. out of 1005
715 th batch is processing.. out of 1005
716 th batch is processing.. out of 1005
717 th batch is processing.. out of 1005
718 th batch is processing.. out of 1005
719 th batch is processing.. out of 1005
720 th batch is processing.. out of 1005
721 th batch is processing.. out of 1005
722 th batch is processing.. out of 1005
723 th batch is processing.. out of 1005
724 th batch is processing.. out of 1005
725 th batch is processing.. out of 1005
726 th batch is processing.. out of 1005
727 th batch is processing.. out of 1005
728 th batch is processing.. out of 1005
729 th batch is processing.. out of 1005
730 th batch is processing.. out of 1005
731 th batch is processing.. out of 1005
732 th batch is processing.. out of 1005
733 th batch is processing.. out of 1005
734 th batch is processing.. out of 1005
735 th batch is processing.. out of 1005
736 th batch is processing.. out of 1005
737 th batch is processing.. out of 1005
738 th batch is processing.. out of 1005
739 th batch is processing.. out of 1005
740 th batch is processing.. out of 1005
741 th batch is processing.. out of 1005
742 th batch is processing.. out of 1005
743 th batch is processing.. out of 1005
744 th batch is processing.. out of 1005
745 th batch is processing.. out of 1005
746 th batch is processing.. out of 1005
747 th batch is processing.. out of 1005
748 th batch is processing.. out of 1005
749 th batch is processing.. out of 1005
750 th batch is processing.. out of 1005
751 th batch is processing.. out of 1005
752 th batch is processing.. out of 1005
753 th batch is processing.. out of 1005
754 th batch is processing.. out of 1005
755 th batch is processing.. out of 1005
756 th batch is processing.. out of 1005
757 th batch is processing.. out of 1005
758 th batch is processing.. out of 1005
759 th batch is processing.. out of 1005
760 th batch is processing.. out of 1005
761 th batch is processing.. out of 1005
762 th batch is processing.. out of 1005
763 th batch is processing.. out of 1005
764 th batch is processing.. out of 1005
765 th batch is processing.. out of 1005
766 th batch is processing.. out of 1005
767 th batch is processing.. out of 1005
768 th batch is processing.. out of 1005
769 th batch is processing.. out of 1005
770 th batch is processing.. out of 1005
771 th batch is processing.. out of 1005
772 th batch is processing.. out of 1005
773 th batch is processing.. out of 1005
774 th batch is processing.. out of 1005
775 th batch is processing.. out of 1005
776 th batch is processing.. out of 1005
777 th batch is processing.. out of 1005
778 th batch is processing.. out of 1005
779 th batch is processing.. out of 1005
780 th batch is processing.. out of 1005
781 th batch is processing.. out of 1005
782 th batch is processing.. out of 1005
783 th batch is processing.. out of 1005
784 th batch is processing.. out of 1005
785 th batch is processing.. out of 1005
786 th batch is processing.. out of 1005
787 th batch is processing.. out of 1005
788 th batch is processing.. out of 1005
789 th batch is processing.. out of 1005
790 th batch is processing.. out of 1005
791 th batch is processing.. out of 1005
792 th batch is processing.. out of 1005
793 th batch is processing.. out of 1005
794 th batch is processing.. out of 1005
795 th batch is processing.. out of 1005
796 th batch is processing.. out of 1005
797 th batch is processing.. out of 1005
798 th batch is processing.. out of 1005
799 th batch is processing.. out of 1005
800 th batch is processing.. out of 1005
801 th batch is processing.. out of 1005
802 th batch is processing.. out of 1005
803 th batch is processing.. out of 1005
804 th batch is processing.. out of 1005
805 th batch is processing.. out of 1005
806 th batch is processing.. out of 1005
807 th batch is processing.. out of 1005
808 th batch is processing.. out of 1005
809 th batch is processing.. out of 1005
810 th batch is processing.. out of 1005
811 th batch is processing.. out of 1005
812 th batch is processing.. out of 1005
813 th batch is processing.. out of 1005
814 th batch is processing.. out of 1005
815 th batch is processing.. out of 1005
816 th batch is processing.. out of 1005
817 th batch is processing.. out of 1005
818 th batch is processing.. out of 1005
819 th batch is processing.. out of 1005
820 th batch is processing.. out of 1005
821 th batch is processing.. out of 1005
822 th batch is processing.. out of 1005
823 th batch is processing.. out of 1005
824 th batch is processing.. out of 1005
825 th batch is processing.. out of 1005
826 th batch is processing.. out of 1005
827 th batch is processing.. out of 1005
828 th batch is processing.. out of 1005
829 th batch is processing.. out of 1005
830 th batch is processing.. out of 1005
831 th batch is processing.. out of 1005
832 th batch is processing.. out of 1005
833 th batch is processing.. out of 1005
834 th batch is processing.. out of 1005
835 th batch is processing.. out of 1005
836 th batch is processing.. out of 1005
837 th batch is processing.. out of 1005
838 th batch is processing.. out of 1005
839 th batch is processing.. out of 1005
840 th batch is processing.. out of 1005
841 th batch is processing.. out of 1005
842 th batch is processing.. out of 1005
843 th batch is processing.. out of 1005
844 th batch is processing.. out of 1005
845 th batch is processing.. out of 1005
846 th batch is processing.. out of 1005
847 th batch is processing.. out of 1005
848 th batch is processing.. out of 1005
849 th batch is processing.. out of 1005
850 th batch is processing.. out of 1005
851 th batch is processing.. out of 1005
852 th batch is processing.. out of 1005
853 th batch is processing.. out of 1005
854 th batch is processing.. out of 1005
855 th batch is processing.. out of 1005
856 th batch is processing.. out of 1005
857 th batch is processing.. out of 1005
858 th batch is processing.. out of 1005
859 th batch is processing.. out of 1005
860 th batch is processing.. out of 1005
861 th batch is processing.. out of 1005
862 th batch is processing.. out of 1005
863 th batch is processing.. out of 1005
864 th batch is processing.. out of 1005
865 th batch is processing.. out of 1005
866 th batch is processing.. out of 1005
867 th batch is processing.. out of 1005
868 th batch is processing.. out of 1005
869 th batch is processing.. out of 1005
870 th batch is processing.. out of 1005
871 th batch is processing.. out of 1005
872 th batch is processing.. out of 1005
873 th batch is processing.. out of 1005
874 th batch is processing.. out of 1005
875 th batch is processing.. out of 1005
876 th batch is processing.. out of 1005
877 th batch is processing.. out of 1005
878 th batch is processing.. out of 1005
879 th batch is processing.. out of 1005
880 th batch is processing.. out of 1005
881 th batch is processing.. out of 1005
882 th batch is processing.. out of 1005
883 th batch is processing.. out of 1005
884 th batch is processing.. out of 1005
885 th batch is processing.. out of 1005
886 th batch is processing.. out of 1005
887 th batch is processing.. out of 1005
888 th batch is processing.. out of 1005
889 th batch is processing.. out of 1005
890 th batch is processing.. out of 1005
891 th batch is processing.. out of 1005
892 th batch is processing.. out of 1005
893 th batch is processing.. out of 1005
894 th batch is processing.. out of 1005
895 th batch is processing.. out of 1005
896 th batch is processing.. out of 1005
897 th batch is processing.. out of 1005
898 th batch is processing.. out of 1005
899 th batch is processing.. out of 1005
900 th batch is processing.. out of 1005
901 th batch is processing.. out of 1005
902 th batch is processing.. out of 1005
903 th batch is processing.. out of 1005
904 th batch is processing.. out of 1005
905 th batch is processing.. out of 1005
906 th batch is processing.. out of 1005
907 th batch is processing.. out of 1005
908 th batch is processing.. out of 1005
909 th batch is processing.. out of 1005
910 th batch is processing.. out of 1005
911 th batch is processing.. out of 1005
912 th batch is processing.. out of 1005
913 th batch is processing.. out of 1005
914 th batch is processing.. out of 1005
915 th batch is processing.. out of 1005
916 th batch is processing.. out of 1005
917 th batch is processing.. out of 1005
918 th batch is processing.. out of 1005
919 th batch is processing.. out of 1005
920 th batch is processing.. out of 1005
921 th batch is processing.. out of 1005
922 th batch is processing.. out of 1005
923 th batch is processing.. out of 1005
924 th batch is processing.. out of 1005
925 th batch is processing.. out of 1005
926 th batch is processing.. out of 1005
927 th batch is processing.. out of 1005
928 th batch is processing.. out of 1005
929 th batch is processing.. out of 1005
930 th batch is processing.. out of 1005
931 th batch is processing.. out of 1005
932 th batch is processing.. out of 1005
933 th batch is processing.. out of 1005
934 th batch is processing.. out of 1005
935 th batch is processing.. out of 1005
936 th batch is processing.. out of 1005
937 th batch is processing.. out of 1005
938 th batch is processing.. out of 1005
939 th batch is processing.. out of 1005
940 th batch is processing.. out of 1005
941 th batch is processing.. out of 1005
942 th batch is processing.. out of 1005
943 th batch is processing.. out of 1005
944 th batch is processing.. out of 1005
945 th batch is processing.. out of 1005
946 th batch is processing.. out of 1005
947 th batch is processing.. out of 1005
948 th batch is processing.. out of 1005
949 th batch is processing.. out of 1005
950 th batch is processing.. out of 1005
951 th batch is processing.. out of 1005
952 th batch is processing.. out of 1005
953 th batch is processing.. out of 1005
954 th batch is processing.. out of 1005
955 th batch is processing.. out of 1005
956 th batch is processing.. out of 1005
957 th batch is processing.. out of 1005
958 th batch is processing.. out of 1005
959 th batch is processing.. out of 1005
960 th batch is processing.. out of 1005
961 th batch is processing.. out of 1005
962 th batch is processing.. out of 1005
963 th batch is processing.. out of 1005
964 th batch is processing.. out of 1005
965 th batch is processing.. out of 1005
966 th batch is processing.. out of 1005
967 th batch is processing.. out of 1005
968 th batch is processing.. out of 1005
969 th batch is processing.. out of 1005
970 th batch is processing.. out of 1005
971 th batch is processing.. out of 1005
972 th batch is processing.. out of 1005
973 th batch is processing.. out of 1005
974 th batch is processing.. out of 1005
975 th batch is processing.. out of 1005
976 th batch is processing.. out of 1005
977 th batch is processing.. out of 1005
978 th batch is processing.. out of 1005
979 th batch is processing.. out of 1005
980 th batch is processing.. out of 1005
981 th batch is processing.. out of 1005
982 th batch is processing.. out of 1005
983 th batch is processing.. out of 1005
984 th batch is processing.. out of 1005
985 th batch is processing.. out of 1005
986 th batch is processing.. out of 1005
987 th batch is processing.. out of 1005
988 th batch is processing.. out of 1005
989 th batch is processing.. out of 1005
990 th batch is processing.. out of 1005
991 th batch is processing.. out of 1005
992 th batch is processing.. out of 1005
993 th batch is processing.. out of 1005
994 th batch is processing.. out of 1005
995 th batch is processing.. out of 1005
996 th batch is processing.. out of 1005
997 th batch is processing.. out of 1005
998 th batch is processing.. out of 1005
999 th batch is processing.. out of 1005
1000 th batch is processing.. out of 1005
1001 th batch is processing.. out of 1005
1002 th batch is processing.. out of 1005
1003 th batch is processing.. out of 1005
1004 th batch is processing.. out of 1005
1005 th batch is processing.. out of 1005
Total earching time :  35358.27755880356
Rank:0 --- ANN NDCG@10:0.5981032093649601 433.0267235802311 724
Eval Time -  481.51034593582153
11/25/2024 00:30:04 - INFO - __main__ -   Chunked 100587 query from 502939
1
2
3
Traceback (most recent call last):
  File "drivers/run_ann_data_gen.py", line 1203, in <module>
    args = parser.parse_args()
  File "drivers/run_ann_data_gen.py", line 1199, in main
    default=False,
  File "drivers/run_ann_data_gen.py", line 1178, in ann_data_gen
    help="Pretrained config name or path if not the same as model_name",
  File "drivers/run_ann_data_gen.py", line 643, in generate_new_ann
    
  File "drivers/run_ann_data_gen.py", line 727, in GenerateNegativePassaageID
    
KeyError: 0
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 361444 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 361443) of binary: /home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/bin/python
Traceback (most recent call last):
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launch.py", line 193, in <module>
    main()
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launch.py", line 189, in main
    launch(args)
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launch.py", line 174, in launch
    run(args)
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/run.py", line 715, in run
    elastic_launch(
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 245, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
drivers/run_ann_data_gen.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-11-25_02:28:11
  host      : uri-gpu002.unity.rc.umass.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 361443)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/hojaeson_umass_edu/hojae_workspace/miniconda3/envs/ance/lib/python3.8/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
11/25/2024 02:28:21 - WARNING - __main__ -   Process rank: 1, device: cuda:1, n_gpu: 1, distributed training: True
11/25/2024 02:28:21 - WARNING - __main__ -   Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True
11/25/2024 02:28:21 - INFO - __main__ -   starting output number 1
11/25/2024 02:28:21 - INFO - __main__ -   Loading query_2_pos_docid
11/25/2024 02:28:21 - INFO - __main__ -   Loading dev query_2_pos_docid
11/25/2024 02:28:21 - INFO - __main__ -   52887
11/25/2024 02:28:21 - INFO - __main__ -   start generate ann data number 1
11/25/2024 02:28:21 - INFO - __main__ -   next checkpoint at /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000
11/25/2024 02:28:21 - INFO - transformers.configuration_utils -   loading configuration file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/config.json
11/25/2024 02:28:21 - INFO - transformers.configuration_utils -   Model config {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "eos_token_id": 2,
  "finetuning_task": "MSMarco",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

11/25/2024 02:28:21 - INFO - transformers.tokenization_utils -   Model name '/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000' not found in model shortcut name list (roberta-base, roberta-large, roberta-large-mnli, distilroberta-base, roberta-base-openai-detector, roberta-large-openai-detector). Assuming '/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000' is a path or url to a directory containing tokenizer files.
11/25/2024 02:28:21 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/vocab.json
11/25/2024 02:28:21 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/merges.txt
11/25/2024 02:28:21 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/added_tokens.json
11/25/2024 02:28:21 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/special_tokens_map.json
11/25/2024 02:28:21 - INFO - transformers.tokenization_utils -   loading file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/tokenizer_config.json
Using mean: False
11/25/2024 02:28:21 - INFO - transformers.modeling_utils -   loading weights file /home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000/pytorch_model.bin
Using mean: False
11/25/2024 02:29:06 - INFO - __main__ -   Inference parameters Namespace(ann_chunk_factor=5, ann_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/ann_data', ann_measure_topk_mrr=True, bottom_neg=False, cache_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/cache', config_name='', data_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/preprocessed_data', device=device(type='cuda', index=0), end_output_num=-1, inference=False, init_model_dir='/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000', last_checkpoint_dir='', limit_total_number=100000, load_gen=False, local_rank=0, max_doc_character=10000, max_query_length=64, max_seq_length=512, model_name_or_path='/home/hojaeson_umass_edu/hojae_workspace/shared/ance/pretrained_bm25-150000', model_type='rdot_nll', n_gpu=1, negative_sample=200, no_cuda=False, only_keep_latest_embedding_file=False, output_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/ann_data', per_gpu_eval_batch_size=2048, rank=0, server_ip='', server_port='12345', tokenizer_name='', topk_training=200, training_dir='/home/hojaeson_umass_edu/hojae_workspace/vector_database/ANCE/data/10/checkpoints', world_size=2)
11/25/2024 02:29:07 - INFO - __main__ -   ***** inference of dev query *****
6980 -1
6980 -1
11/25/2024 02:29:07 - INFO - __main__ -   ***** Running ANN Embedding Inference *****
11/25/2024 02:29:07 - INFO - __main__ -     Batch size = 2048
Inferencing: 0it [00:00, ?it/s]Inferencing: 2it [00:04,  2.01s/it]
11/25/2024 02:29:11 - INFO - __main__ -   merging embeddings
11/25/2024 02:29:11 - INFO - __main__ -   ***** inference of passages *****
884182 -1
884182 -1
11/25/2024 02:29:11 - INFO - __main__ -   ***** Running ANN Embedding Inference *****
11/25/2024 02:29:11 - INFO - __main__ -     Batch size = 2048
Inferencing: 0it [00:00, ?it/s]Inferencing: 0it [00:15, ?it/s]Inferencing: 3it [00:21,  7.04s/it]Inferencing: 4it [00:28,  7.01s/it]Inferencing: 5it [00:34,  6.97s/it]Inferencing: 6it [00:41,  6.94s/it]Inferencing: 7it [00:48,  6.93s/it]Inferencing: 8it [00:55,  6.91s/it]Inferencing: 9it [01:02,  6.93s/it]Inferencing: 10it [01:09,  6.91s/it]Inferencing: 11it [01:16,  6.90s/it]Inferencing: 12it [01:23,  6.89s/it]Inferencing: 13it [01:30,  6.90s/it]Inferencing: 14it [01:36,  6.89s/it]Inferencing: 15it [01:43,  6.88s/it]Inferencing: 16it [01:50,  6.88s/it]Inferencing: 17it [01:57,  6.88s/it]Inferencing: 18it [02:04,  6.90s/it]Inferencing: 19it [02:11,  6.89s/it]Inferencing: 20it [02:18,  6.89s/it]Inferencing: 21it [02:25,  6.89s/it]Inferencing: 22it [02:32,  6.91s/it]Inferencing: 23it [02:39,  6.91s/it]Inferencing: 24it [02:45,  6.90s/it]Inferencing: 25it [02:52,  6.90s/it]Inferencing: 26it [02:59,  6.90s/it]Inferencing: 27it [03:06,  6.90s/it]Inferencing: 28it [03:13,  6.89s/it]Inferencing: 29it [03:20,  6.89s/it]Inferencing: 30it [03:27,  6.88s/it]Inferencing: 31it [03:34,  6.88s/it]Inferencing: 32it [03:41,  6.89s/it]Inferencing: 33it [03:47,  6.89s/it]Inferencing: 34it [03:54,  6.89s/it]Inferencing: 35it [04:01,  6.88s/it]Inferencing: 36it [04:08,  6.90s/it]Inferencing: 37it [04:15,  6.89s/it]Inferencing: 38it [04:22,  6.89s/it]Inferencing: 39it [04:29,  6.89s/it]Inferencing: 40it [04:36,  6.89s/it]Inferencing: 41it [04:43,  6.92s/it]Inferencing: 42it [04:50,  6.91s/it]Inferencing: 43it [04:56,  6.91s/it]Inferencing: 44it [05:03,  6.90s/it]Inferencing: 45it [05:10,  6.91s/it]Inferencing: 46it [05:17,  6.91s/it]Inferencing: 47it [05:24,  6.90s/it]Inferencing: 48it [05:31,  6.89s/it]Inferencing: 49it [05:38,  6.89s/it]Inferencing: 50it [05:45,  6.90s/it]Inferencing: 51it [05:52,  6.89s/it]Inferencing: 52it [05:58,  6.88s/it]Inferencing: 53it [06:05,  6.88s/it]Inferencing: 54it [06:12,  6.89s/it]Inferencing: 55it [06:19,  6.89s/it]Inferencing: 56it [06:26,  6.89s/it]Inferencing: 57it [06:33,  6.89s/it]Inferencing: 58it [06:40,  6.89s/it]Inferencing: 59it [06:47,  6.90s/it]Inferencing: 60it [06:54,  6.90s/it]Inferencing: 61it [07:01,  6.89s/it]Inferencing: 62it [07:07,  6.90s/it]Inferencing: 63it [07:14,  6.90s/it]Inferencing: 64it [07:21,  6.91s/it]Inferencing: 65it [07:28,  6.90s/it]Inferencing: 66it [07:35,  6.89s/it]Inferencing: 67it [07:42,  6.89s/it]Inferencing: 68it [07:49,  6.90s/it]Inferencing: 69it [07:56,  6.89s/it]Inferencing: 70it [08:03,  6.89s/it]Inferencing: 71it [08:09,  6.88s/it]Inferencing: 72it [08:16,  6.88s/it]Inferencing: 73it [08:23,  6.89s/it]Inferencing: 74it [08:30,  6.88s/it]Inferencing: 75it [08:37,  6.88s/it]Inferencing: 76it [08:44,  6.88s/it]Inferencing: 77it [08:51,  6.90s/it]Inferencing: 78it [08:58,  6.90s/it]Inferencing: 79it [09:05,  6.89s/it]Inferencing: 80it [09:11,  6.89s/it]Inferencing: 81it [09:18,  6.89s/it]Inferencing: 82it [09:25,  6.90s/it]Inferencing: 83it [09:32,  6.90s/it]Inferencing: 84it [09:39,  6.90s/it]Inferencing: 85it [09:46,  6.90s/it]Inferencing: 86it [09:53,  6.90s/it]Inferencing: 87it [10:00,  6.90s/it]Inferencing: 88it [10:07,  6.89s/it]Inferencing: 89it [10:14,  6.89s/it]Inferencing: 90it [10:20,  6.88s/it]Inferencing: 91it [10:27,  6.89s/it]Inferencing: 92it [10:34,  6.88s/it]Inferencing: 93it [10:41,  6.88s/it]Inferencing: 94it [10:48,  6.89s/it]Inferencing: 95it [10:55,  6.88s/it]Inferencing: 96it [11:02,  6.89s/it]Inferencing: 97it [11:09,  6.89s/it]Inferencing: 98it [11:15,  6.88s/it]Inferencing: 99it [11:22,  6.89s/it]Inferencing: 100it [11:29,  6.90s/it]Inferencing: 101it [11:36,  6.90s/it]Inferencing: 102it [11:43,  6.90s/it]Inferencing: 103it [11:50,  6.90s/it]Inferencing: 104it [11:57,  6.90s/it]Inferencing: 105it [12:04,  6.91s/it]Inferencing: 106it [12:11,  6.90s/it]Inferencing: 107it [12:18,  6.90s/it]Inferencing: 108it [12:24,  6.89s/it]Inferencing: 109it [12:31,  6.89s/it]Inferencing: 110it [12:38,  6.89s/it]Inferencing: 111it [12:45,  6.89s/it]Inferencing: 112it [12:52,  6.88s/it]Inferencing: 113it [12:59,  6.88s/it]Inferencing: 114it [13:06,  6.89s/it]Inferencing: 115it [13:13,  6.89s/it]Inferencing: 116it [13:20,  6.89s/it]Inferencing: 117it [13:26,  6.89s/it]Inferencing: 118it [13:33,  6.88s/it]Inferencing: 119it [13:40,  6.90s/it]Inferencing: 120it [13:47,  6.90s/it]Inferencing: 121it [13:54,  6.89s/it]Inferencing: 122it [14:01,  6.89s/it]Inferencing: 123it [14:08,  6.91s/it]Inferencing: 124it [14:15,  6.91s/it]Inferencing: 125it [14:22,  6.90s/it]Inferencing: 126it [14:29,  6.89s/it]Inferencing: 127it [14:35,  6.89s/it]Inferencing: 128it [14:42,  6.90s/it]Inferencing: 129it [14:49,  6.90s/it]Inferencing: 130it [14:56,  6.89s/it]Inferencing: 131it [15:03,  6.89s/it]Inferencing: 132it [15:10,  6.90s/it]Inferencing: 133it [15:17,  6.89s/it]Inferencing: 134it [15:24,  6.89s/it]Inferencing: 135it [15:31,  6.89s/it]Inferencing: 136it [15:37,  6.89s/it]Inferencing: 137it [15:44,  6.90s/it]Inferencing: 138it [15:51,  6.89s/it]Inferencing: 139it [15:58,  6.90s/it]Inferencing: 140it [16:05,  6.89s/it]Inferencing: 141it [16:12,  6.89s/it]Inferencing: 142it [16:19,  6.90s/it]Inferencing: 143it [16:26,  6.90s/it]Inferencing: 144it [16:33,  6.90s/it]Inferencing: 145it [16:40,  6.90s/it]Inferencing: 146it [16:46,  6.91s/it]Inferencing: 147it [16:53,  6.91s/it]Inferencing: 148it [17:00,  6.90s/it]Inferencing: 149it [17:07,  6.89s/it]Inferencing: 150it [17:14,  6.88s/it]Inferencing: 151it [17:21,  6.89s/it]Inferencing: 152it [17:28,  6.89s/it]Inferencing: 153it [17:35,  6.89s/it]Inferencing: 154it [17:42,  6.89s/it]Inferencing: 155it [17:49,  6.91s/it]Inferencing: 156it [17:55,  6.90s/it]Inferencing: 157it [18:02,  6.89s/it]Inferencing: 158it [18:09,  6.89s/it]Inferencing: 159it [18:16,  6.89s/it]Inferencing: 160it [18:23,  6.91s/it]Inferencing: 161it [18:30,  6.90s/it]Inferencing: 162it [18:37,  6.90s/it]Inferencing: 163it [18:44,  6.90s/it]Inferencing: 164it [18:51,  6.90s/it]Inferencing: 165it [18:58,  6.91s/it]Inferencing: 166it [19:04,  6.90s/it]Inferencing: 167it [19:11,  6.89s/it]Inferencing: 168it [19:18,  6.90s/it]Inferencing: 169it [19:25,  6.90s/it]Inferencing: 170it [19:32,  6.89s/it]Inferencing: 171it [19:39,  6.88s/it]Inferencing: 172it [19:46,  6.88s/it]Inferencing: 173it [19:53,  6.88s/it]Inferencing: 174it [20:00,  6.89s/it]Inferencing: 175it [20:06,  6.89s/it]Inferencing: 176it [20:13,  6.89s/it]Inferencing: 177it [20:20,  6.89s/it]Inferencing: 178it [20:27,  6.90s/it]Inferencing: 179it [20:34,  6.90s/it]Inferencing: 180it [20:41,  6.89s/it]Inferencing: 181it [20:48,  6.89s/it]Inferencing: 182it [20:55,  6.89s/it]Inferencing: 183it [21:02,  6.91s/it]Inferencing: 184it [21:09,  6.91s/it]Inferencing: 185it [21:15,  6.90s/it]Inferencing: 186it [21:22,  6.89s/it]Inferencing: 187it [21:29,  6.90s/it]slurmstepd-uri-gpu002: error: *** JOB 26343082 ON uri-gpu002 CANCELLED AT 2024-11-25T02:50:45 ***
slurmstepd-uri-gpu002: error: container_p_join: open failed for /var/tmp//uri-gpu002/26343082/.ns: No such file or directory
slurmstepd-uri-gpu002: error: container_g_join(26343082): No such file or directory
